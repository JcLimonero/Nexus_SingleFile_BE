"use strict";(self.webpackChunkvex=self.webpackChunkvex||[]).push([[8713],{8713:(K,_,i)=>{i.r(_),i.d(_,{ProcesosComponent:()=>X});var g=i(6814),n=i(6223),c=i(5313),p=i(2296),h=i(617),u=i(9347),m=i(4170),f=i(4516),x=i(8525),U=i(5986),Z=i(2939),T=i(1476),C=i(3566),b=i(2596),D=i(2557),I=i(5195),N=i(6385),v=i(5940),t=i(9212),F=i(9862);let y=(()=>{class o{constructor(e){this.http=e,this.API_URL="/api/process"}getProcesos(){return this.http.get(this.API_URL)}getProceso(e){return this.http.get(`${this.API_URL}/${e}`)}createProceso(e){return this.http.post(this.API_URL,e)}updateProceso(e){return this.http.put(`${this.API_URL}/${e.Id}`,e)}deleteProceso(e){return this.http.delete(`${this.API_URL}/${e}`)}toggleEstado(e,r){return this.http.patch(`${this.API_URL}/${e}/estado`,{estado:r})}static#t=this.\u0275fac=function(r){return new(r||o)(t.LFG(F.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var P=i(3680);function q(o,l){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," El nombre es requerido "),t.qZA())}function S(o,l){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," El nombre debe tener al menos 3 caracteres "),t.qZA())}function w(o,l){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," El nombre no puede exceder 600 caracteres "),t.qZA())}function k(o,l){if(1&o&&(t.TgZ(0,"div",16)(1,"h3",17),t._uU(2,"Informaci\xf3n del Sistema"),t.qZA(),t.TgZ(3,"div",18)(4,"div")(5,"span",19),t._uU(6,"ID:"),t.qZA(),t.TgZ(7,"span",20),t._uU(8),t.qZA()(),t.TgZ(9,"div")(10,"span",19),t._uU(11,"\xdaltimo Usuario:"),t.qZA(),t.TgZ(12,"span",21),t._uU(13),t.qZA()(),t.TgZ(14,"div")(15,"span",19),t._uU(16,"Fecha Registro:"),t.qZA(),t.TgZ(17,"span",21),t._uU(18),t.qZA()(),t.TgZ(19,"div")(20,"span",19),t._uU(21,"\xdaltima Actualizaci\xf3n:"),t.qZA(),t.TgZ(22,"span",21),t._uU(23),t.qZA()()()()),2&o){const e=t.oxw();t.xp6(8),t.Oqu(e.data.proceso.Id),t.xp6(5),t.Oqu(e.data.proceso.LastUserUpdateName||"N/A"),t.xp6(5),t.Oqu(e.data.proceso.RegistrationDate||"N/A"),t.xp6(5),t.Oqu(e.data.proceso.UpdateDate||"N/A")}}function J(o,l){1&o&&t._UZ(0,"mat-spinner",22)}function R(o,l){if(1&o&&(t.TgZ(0,"mat-icon"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(),t.Oqu("edit"===e.data.mode?"save":"add")}}let A=(()=>{class o{constructor(e,r,a,s,d){this.fb=e,this.procesoService=r,this.snackBar=a,this.dialogRef=s,this.data=d,this.loading=!1,this.initializeForm()}ngOnInit(){"edit"===this.data.mode&&this.populateForm()}initializeForm(){this.procesoForm=this.fb.group({Name:["",[n.kI.required,n.kI.minLength(3),n.kI.maxLength(600)]],Enabled:["1",n.kI.required]})}populateForm(){this.data.proceso&&this.procesoForm.patchValue({Name:this.data.proceso.Name,Enabled:this.data.proceso.Enabled})}onSubmit(){this.procesoForm.valid?(this.loading=!0,"edit"===this.data.mode?this.updateProceso():this.createProceso()):this.markFormGroupTouched()}updateProceso(){const e={Id:this.data.proceso.Id,...this.procesoForm.value};this.procesoService.updateProceso(e).subscribe({next:r=>{this.loading=!1,r.success?(this.snackBar.open("Proceso actualizado exitosamente","\xc9xito",{duration:2e3}),this.dialogRef.close(!0)):this.snackBar.open(r.message||"Error al actualizar proceso","Error",{duration:3e3})},error:r=>{this.loading=!1,console.error("Error updating proceso:",r),this.snackBar.open("Error al actualizar proceso","Error",{duration:3e3})}})}createProceso(){this.procesoService.createProceso(this.procesoForm.value).subscribe({next:e=>{this.loading=!1,e.success?(this.snackBar.open("Proceso creado exitosamente","\xc9xito",{duration:2e3}),this.dialogRef.close(!0)):this.snackBar.open(e.message||"Error al crear proceso","Error",{duration:3e3})},error:e=>{this.loading=!1,console.error("Error creating proceso:",e),this.snackBar.open("Error al crear proceso","Error",{duration:3e3})}})}onCancel(){this.dialogRef.close()}markFormGroupTouched(){Object.keys(this.procesoForm.controls).forEach(e=>{this.procesoForm.get(e)?.markAsTouched()})}static#t=this.\u0275fac=function(r){return new(r||o)(t.Y36(n.qu),t.Y36(y),t.Y36(Z.ux),t.Y36(u.so),t.Y36(u.WI))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-proceso-edit-dialog"]],standalone:!0,features:[t.jDz],decls:35,vars:11,consts:[[1,"p-6","min-w-[500px]"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],["mat-icon-button","","matTooltip","Cerrar",3,"click"],[1,"space-y-4",3,"formGroup","ngSubmit"],["appearance","outline",1,"w-full"],["matInput","","formControlName","Name","placeholder","Ej: Gesti\xf3n de Clientes","maxlength","600"],[4,"ngIf"],["formControlName","Enabled"],["value","1"],["value","0"],["class","bg-gray-50 p-4 rounded-lg",4,"ngIf"],[1,"flex","justify-end","space-x-3","pt-4","border-t"],["type","button","mat-button","",3,"disabled","click"],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["diameter","20","class","mr-2",4,"ngIf"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"text-sm","font-medium","text-gray-700","mb-2"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"text-gray-500"],[1,"ml-2","font-mono"],[1,"ml-2"],["diameter","20",1,"mr-2"]],template:function(r,a){if(1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return a.onCancel()}),t.TgZ(5,"mat-icon"),t._uU(6,"close"),t.qZA()()(),t.TgZ(7,"form",4),t.NdJ("ngSubmit",function(){return a.onSubmit()}),t.TgZ(8,"mat-form-field",5)(9,"mat-label"),t._uU(10,"Nombre del Proceso"),t.qZA(),t._UZ(11,"input",6),t.TgZ(12,"mat-hint"),t._uU(13,"Nombre completo del proceso (m\xe1ximo 600 caracteres)"),t.qZA(),t.YNc(14,q,2,0,"mat-error",7)(15,S,2,0,"mat-error",7)(16,w,2,0,"mat-error",7),t.qZA(),t.TgZ(17,"mat-form-field",5)(18,"mat-label"),t._uU(19,"Estado"),t.qZA(),t.TgZ(20,"mat-select",8)(21,"mat-option",9),t._uU(22,"Activo"),t.qZA(),t.TgZ(23,"mat-option",10),t._uU(24,"Inactivo"),t.qZA()(),t.TgZ(25,"mat-hint"),t._uU(26,"Estado actual del proceso"),t.qZA()(),t.YNc(27,k,24,4,"div",11),t.TgZ(28,"div",12)(29,"button",13),t.NdJ("click",function(){return a.onCancel()}),t._uU(30," Cancelar "),t.qZA(),t.TgZ(31,"button",14),t.YNc(32,J,1,0,"mat-spinner",15)(33,R,2,1,"mat-icon",7),t._uU(34),t.qZA()()()()),2&r){let s,d,E;t.xp6(3),t.hij(" ","edit"===a.data.mode?"Editar Proceso":"Nuevo Proceso"," "),t.xp6(4),t.Q6J("formGroup",a.procesoForm),t.xp6(7),t.Q6J("ngIf",null==(s=a.procesoForm.get("Name"))?null:s.hasError("required")),t.xp6(),t.Q6J("ngIf",null==(d=a.procesoForm.get("Name"))?null:d.hasError("minlength")),t.xp6(),t.Q6J("ngIf",null==(E=a.procesoForm.get("Name"))?null:E.hasError("maxlength")),t.xp6(11),t.Q6J("ngIf","edit"===a.data.mode),t.xp6(2),t.Q6J("disabled",a.loading),t.xp6(2),t.Q6J("disabled",a.procesoForm.invalid||a.loading),t.xp6(),t.Q6J("ngIf",a.loading),t.xp6(),t.Q6J("ngIf",!a.loading),t.xp6(),t.hij(" ","edit"===a.data.mode?"Guardar Cambios":"Crear Proceso"," ")}},dependencies:[g.ez,g.O5,n.UX,n._Y,n.Fj,n.JJ,n.JL,n.nD,n.sg,n.u,u.Is,m.lN,m.KE,m.hX,m.bx,m.TO,f.c,f.Nt,x.LD,x.gD,P.ey,p.ot,p.lW,p.RK,h.Ps,h.Hw,Z.ZX,v.Cq,v.Ou],encapsulation:2})}return o})();function Q(o,l){1&o&&(t.TgZ(0,"th",32),t._uU(1," ID "),t.qZA())}function B(o,l){if(1&o&&(t.TgZ(0,"td",33),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.xp6(),t.hij(" ",e.Id," ")}}function M(o,l){1&o&&(t.TgZ(0,"th",34),t._uU(1," Nombre "),t.qZA())}function L(o,l){if(1&o&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.xp6(),t.hij(" ",e.Name," ")}}function Y(o,l){1&o&&(t.TgZ(0,"th",36),t._uU(1," Estado "),t.qZA())}function z(o,l){if(1&o&&(t.TgZ(0,"td",37)(1,"div",38),t._UZ(2,"div",39),t.TgZ(3,"span",40),t._uU(4),t.qZA()()()),2&o){const e=l.$implicit;t.xp6(2),t.Q6J("ngClass","1"===e.Enabled?"bg-green-500":"bg-red-500"),t.xp6(),t.Q6J("ngClass","1"===e.Enabled?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),t.xp6(),t.hij(" ","1"===e.Enabled?"Activo":"Inactivo"," ")}}function j(o,l){1&o&&(t.TgZ(0,"th",41),t._uU(1," Acciones "),t.qZA())}function O(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"td",42)(1,"div",43)(2,"button",44),t.NdJ("click",function(){const s=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.openEditDialog(s))}),t.TgZ(3,"mat-icon",45),t._uU(4,"edit"),t.qZA()(),t.TgZ(5,"button",46),t.NdJ("click",function(){const s=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.deleteProceso(s))}),t.TgZ(6,"mat-icon",45),t._uU(7,"delete"),t.qZA()()()()}}function $(o,l){1&o&&t._UZ(0,"tr",47)}function G(o,l){1&o&&t._UZ(0,"tr",48)}const H=()=>[10,25,50,100];let X=(()=>{class o{constructor(e,r,a,s){this.procesoService=e,this.dialog=r,this.snackBar=a,this.cdr=s,this.procesos=[],this.dataSource=new c.by([]),this.totalProcesos=0,this.searchTerm="",this.statusFilter="",this.displayedColumns=["Id","Name","Enabled","acciones"],this.loading=!1}ngOnInit(){this.loadProcesos()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource.filterPredicate=(e,r)=>{const a=r.toLowerCase();return e.Name.toLowerCase().includes(a)}}loadProcesos(){this.loading=!0,this.procesoService.getProcesos().subscribe({next:e=>{e.success&&e.data?.processes?(this.procesos=e.data.processes,this.totalProcesos=e.data.total,this.dataSource.data=this.procesos,this.applyFilter()):this.snackBar.open(e.message||"Error al cargar procesos","Error",{duration:3e3}),this.loading=!1,this.cdr.markForCheck()},error:e=>{console.error("Error loading procesos:",e),this.snackBar.open("Error de conexi\xf3n al cargar procesos","Error",{duration:3e3}),this.loading=!1,this.cdr.markForCheck()}})}applyFilter(){let e="";if(this.searchTerm&&(e=this.searchTerm),this.dataSource.filter=e.trim().toLowerCase(),""!==this.statusFilter){const r="true"===this.statusFilter?"1":"0";this.dataSource.data=this.procesos.filter(a=>a.Enabled===r&&(""===e||a.Name.toLowerCase().includes(e.toLowerCase())))}else this.dataSource.data=this.procesos,this.dataSource.filter=e.trim().toLowerCase();this.dataSource.paginator&&this.dataSource.paginator.firstPage()}refreshData(){this.loadProcesos()}openCreateDialog(){this.dialog.open(A,{width:"600px",data:{proceso:{},mode:"create"},disableClose:!1}).afterClosed().subscribe(a=>{a&&this.refreshData()})}openEditDialog(e){this.dialog.open(A,{width:"600px",data:{proceso:e,mode:"edit"},disableClose:!1}).afterClosed().subscribe(s=>{s&&this.refreshData()})}deleteProceso(e){confirm(`\xbfEst\xe1s seguro de que quieres eliminar el proceso "${e.Name}"?`)&&this.procesoService.deleteProceso(e.Id).subscribe({next:r=>{r.success?(this.procesos=this.procesos.filter(a=>a.Id!==e.Id),this.applyFilter(),this.snackBar.open("Proceso eliminado exitosamente","\xc9xito",{duration:2e3})):this.snackBar.open(r.message||"Error al eliminar proceso","Error",{duration:3e3})},error:r=>{console.error("Error deleting proceso:",r),this.snackBar.open("Error al eliminar proceso","Error",{duration:3e3})}})}getPageRange(){if(!this.paginator||0===this.dataSource.filteredData.length)return"0-0";const e=this.paginator.pageIndex*this.paginator.pageSize+1;return`${e}-${Math.min(e+this.paginator.pageSize-1,this.dataSource.filteredData.length)}`}static#t=this.\u0275fac=function(r){return new(r||o)(t.Y36(y),t.Y36(u.uw),t.Y36(Z.ux),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-procesos"]],viewQuery:function(r,a){if(1&r&&(t.Gf(T.NW,5),t.Gf(C.YE,5)),2&r){let s;t.iGM(s=t.CRH())&&(a.paginator=s.first),t.iGM(s=t.CRH())&&(a.sort=s.first)}},standalone:!0,features:[t.jDz],decls:48,vars:12,consts:[[1,"p-6"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],["mat-raised-button","","color","primary",1,"flex","items-center","gap-2",3,"click"],[1,"bg-white","rounded-lg","shadow-sm","border","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline",1,"w-full"],["matInput","","placeholder","Buscar por nombre...","maxlength","100",3,"ngModel","ngModelChange"],["matSuffix",""],[3,"ngModel","ngModelChange"],["value",""],["value","1"],["value","0"],[1,"bg-white","rounded-lg","shadow-sm","border","overflow-hidden"],["mat-table","","matSort","",1,"w-full",2,"line-height","1",3,"dataSource"],["matColumnDef","Id"],["mat-header-cell","","mat-sort-header","","class","w-16 text-center py-1 bg-gray-50 text-xs font-medium text-gray-700",4,"matHeaderCellDef"],["mat-cell","","class","text-xs font-mono text-gray-600 py-0",4,"matCellDef"],["matColumnDef","Name"],["mat-header-cell","","mat-sort-header","","class","min-w-0 flex-1 py-1 bg-gray-50 text-xs font-medium text-gray-700",4,"matHeaderCellDef"],["mat-cell","","class","text-xs py-0",4,"matCellDef"],["matColumnDef","Enabled"],["mat-header-cell","","mat-sort-header","","class","w-24 text-center py-1 bg-gray-50 text-xs font-medium text-gray-700",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","acciones"],["mat-header-cell","","class","w-28 text-center py-1 bg-gray-50 text-xs font-medium text-gray-700",4,"matHeaderCellDef"],["mat-cell","","class","text-center py-0",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","!min-h-0 !h-8",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",1,"border-t",3,"pageSizeOptions","pageSize","length"],[1,"mt-4","text-sm","text-gray-600","text-center"],["mat-header-cell","","mat-sort-header","",1,"w-16","text-center","py-1","bg-gray-50","text-xs","font-medium","text-gray-700"],["mat-cell","",1,"text-xs","font-mono","text-gray-600","py-0"],["mat-header-cell","","mat-sort-header","",1,"min-w-0","flex-1","py-1","bg-gray-50","text-xs","font-medium","text-gray-700"],["mat-cell","",1,"text-xs","py-0"],["mat-header-cell","","mat-sort-header","",1,"w-24","text-center","py-1","bg-gray-50","text-xs","font-medium","text-gray-700"],["mat-cell","",1,"text-center"],[1,"flex","items-center","justify-center"],[1,"w-0.5","h-0.5","rounded-full","mr-2",3,"ngClass"],[1,"px-1.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["mat-header-cell","",1,"w-28","text-center","py-1","bg-gray-50","text-xs","font-medium","text-gray-700"],["mat-cell","",1,"text-center","py-0"],[1,"flex","gap-0.5","justify-center","items-center"],["mat-icon-button","","color","primary","matTooltip","Editar",1,"!w-6","!h-6","!min-h-6","!p-0",3,"click"],[1,"!text-sm"],["mat-icon-button","","color","warn","matTooltip","Eliminar",1,"!w-6","!h-6","!min-h-6","!p-0",3,"click"],["mat-header-row",""],["mat-row","",1,"!min-h-0","!h-8"]],template:function(r,a){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),t._uU(4,"Gesti\xf3n de Procesos"),t.qZA(),t.TgZ(5,"p",3),t._uU(6,"Administra los procesos del sistema"),t.qZA()(),t.TgZ(7,"button",4),t.NdJ("click",function(){return a.openCreateDialog()}),t.TgZ(8,"mat-icon"),t._uU(9,"add_circle"),t.qZA(),t._uU(10," Nuevo Proceso "),t.qZA()(),t.TgZ(11,"div",5)(12,"div",6)(13,"mat-form-field",7)(14,"mat-label"),t._uU(15,"Buscar procesos"),t.qZA(),t.TgZ(16,"input",8),t.NdJ("ngModelChange",function(d){return a.searchTerm=d})("ngModelChange",function(){return a.applyFilter()}),t.qZA(),t.TgZ(17,"mat-icon",9),t._uU(18,"\u{1f50d}"),t.qZA()(),t.TgZ(19,"mat-form-field",7)(20,"mat-label"),t._uU(21,"Estado"),t.qZA(),t.TgZ(22,"mat-select",10),t.NdJ("ngModelChange",function(d){return a.statusFilter=d})("ngModelChange",function(){return a.applyFilter()}),t.TgZ(23,"mat-option",11),t._uU(24,"Todos"),t.qZA(),t.TgZ(25,"mat-option",12),t._uU(26,"Activos"),t.qZA(),t.TgZ(27,"mat-option",13),t._uU(28,"Inactivos"),t.qZA()()()()(),t.TgZ(29,"div",14)(30,"table",15),t.ynx(31,16),t.YNc(32,Q,2,0,"th",17)(33,B,2,1,"td",18),t.BQk(),t.ynx(34,19),t.YNc(35,M,2,0,"th",20)(36,L,2,1,"td",21),t.BQk(),t.ynx(37,22),t.YNc(38,Y,2,0,"th",23)(39,z,5,3,"td",24),t.BQk(),t.ynx(40,25),t.YNc(41,j,2,0,"th",26)(42,O,8,0,"td",27),t.BQk(),t.YNc(43,$,1,0,"tr",28)(44,G,1,0,"tr",29),t.qZA(),t._UZ(45,"mat-paginator",30),t.qZA(),t.TgZ(46,"div",31),t._uU(47),t.qZA()()),2&r&&(t.xp6(16),t.Q6J("ngModel",a.searchTerm),t.xp6(6),t.Q6J("ngModel",a.statusFilter),t.xp6(8),t.Q6J("dataSource",a.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(),t.Q6J("pageSizeOptions",t.DdM(11,H))("pageSize",10)("length",a.dataSource.filteredData.length),t.xp6(2),t.lnq(" Mostrando ",a.getPageRange()," de ",a.dataSource.filteredData.length," procesos visibles (",a.procesos.length," total) "))},dependencies:[g.ez,g.mk,n.UX,n.Fj,n.JJ,n.nD,n.u5,n.On,c.p0,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,p.ot,p.lW,p.RK,h.Ps,h.Hw,u.Is,m.lN,m.KE,m.hX,m.R9,f.c,f.Nt,x.LD,x.gD,P.ey,U.p9,Z.ZX,T.TU,T.NW,C.JX,C.YE,C.nU,b.AV,b.gM,D.Hi,I.QW,N.t],encapsulation:2})}return o})()}}]);