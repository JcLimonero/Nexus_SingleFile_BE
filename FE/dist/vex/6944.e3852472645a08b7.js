"use strict";(self.webpackChunkvex=self.webpackChunkvex||[]).push([[6944],{3951:(E,u,o)=>{o.d(u,{$:()=>m});var e=o(6825);const m=function _(d){return(0,e.X$)("fadeInUp",[(0,e.eR)(":enter",[(0,e.oB)({transform:"translateY(20px)",opacity:0}),(0,e.jt)(`${d}ms cubic-bezier(0.35, 0, 0.25, 1)`,(0,e.oB)({transform:"translateY(0)",opacity:1}))])])}(400)},6944:(E,u,o)=>{o.r(u),o.d(u,{LoginComponent:()=>L});var e=o(6223),_=o(9522),m=o(2939),d=o(3951),f=o(5986),v=o(617),h=o(2596),g=o(2296),b=o(6814),x=o(4516),i=o(4170),I=o(8180),t=o(9212),T=o(304);function C(r,l){1&r&&(t.TgZ(0,"mat-error"),t._uU(1,"Necesitamos un correo electr\xf3nico para iniciar sesi\xf3n "),t.qZA())}function A(r,l){1&r&&t._UZ(0,"mat-icon",22)}function k(r,l){1&r&&t._UZ(0,"mat-icon",23)}function D(r,l){1&r&&(t.TgZ(0,"mat-error"),t._uU(1,"Necesitamos una contrase\xf1a para iniciar sesi\xf3n "),t.qZA())}function Z(r,l){1&r&&(t.TgZ(0,"span"),t._uU(1,"INICIAR SESI\xd3N"),t.qZA())}function O(r,l){1&r&&(t.TgZ(0,"span"),t._uU(1,"INICIANDO..."),t.qZA())}const U=()=>["/forgot-password"];let L=(()=>{class r{constructor(c,n,a,s,p){this.router=c,this.fb=n,this.cd=a,this.snackbar=s,this.authService=p,this.form=this.fb.group({email:["",[e.kI.required,e.kI.email]],password:["",e.kI.required]}),this.inputType="password",this.visible=!1,this.loading=!1}send(){if(this.form.valid&&!this.loading){this.loading=!0,this.cd.markForCheck();const c={email:this.form.get("email")?.value||"",password:this.form.get("password")?.value||""};this.authService.login(c).subscribe({next:n=>{this.loading=!1,this.cd.markForCheck(),console.log("\u{1f510} Respuesta del login:",n),n.success?(this.snackbar.open("Inicio de sesi\xf3n exitoso"+(n.user?.role_name||n.user?.role?` (${n.user.role_name||n.user.role})`:""),"OK",{duration:3e3}),console.log("\u{1f9ed} Esperando a que el estado se actualice..."),this.authService.isAuthenticated$.pipe((0,I.q)(1)).subscribe(s=>{s?(console.log("\u2705 Estado actualizado, navegando a /..."),this.router.navigate(["/"]).then(()=>{console.log("\u2705 Navegaci\xf3n exitosa a /")}).catch(p=>{console.error("\u274c Error en navegaci\xf3n:",p)})):console.error("\u274c Estado no se actualiz\xf3 correctamente")})):(console.log("\u274c Login fallido:",n.message),this.snackbar.open(n.message||"Error en el inicio de sesi\xf3n","Error",{duration:5e3}))},error:n=>{this.loading=!1,this.cd.markForCheck(),console.error("Error en login:",n),this.snackbar.open("Error de conexi\xf3n. Verifica tu conexi\xf3n a internet.","Error",{duration:5e3})}})}else this.form.invalid&&this.snackbar.open("Por favor, completa todos los campos correctamente","Error",{duration:3e3})}toggleVisibility(){this.visible?(this.inputType="password",this.visible=!1,this.cd.markForCheck()):(this.inputType="text",this.visible=!0,this.cd.markForCheck())}testLogout(){console.log("\u{1f9ea} Probando logout desde el componente..."),this.authService.testLogout()}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(_.F0),t.Y36(e.qu),t.Y36(t.sBO),t.Y36(m.ux),t.Y36(T.e))};static#o=this.\u0275cmp=t.Xpm({type:r,selectors:[["vex-login"]],standalone:!0,features:[t.jDz],decls:37,vars:12,consts:[[1,"w-full","h-full","bg-pattern","flex","flex-col","items-center","justify-center"],[1,"card","overflow-hidden","w-full","max-w-md"],[1,"p-6","pb-0","flex","flex-col","items-center","justify-center"],[1,"fill-current","text-center"],["src","assets/img/logo/logo.svg",1,"w-16"],[1,"text-center","mt-4"],[1,"title","m-0"],[1,"body-2","text-secondary","m-0"],[1,"p-6","flex","flex-col","gap-4",3,"formGroup"],[1,"flex","flex-col"],[1,"flex-1"],["formControlName","email","matInput","","required",""],[4,"ngIf"],["formControlName","password","matInput","","required","",3,"type"],["mat-icon-button","","matIconSuffix","","matTooltip","Alternar visibilidad","type","button",3,"click"],["svgIcon","mat:visibility",4,"ngIf"],["svgIcon","mat:visibility_off",4,"ngIf"],[1,"flex","items-center","justify-between"],["color","primary",1,"caption"],[1,"caption",3,"routerLink"],["color","primary","mat-raised-button","","type","button",3,"disabled","click"],["color","warn","mat-button","","type","button",1,"mt-2",3,"click"],["svgIcon","mat:visibility"],["svgIcon","mat:visibility_off"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._UZ(4,"img",4),t.qZA()(),t.TgZ(5,"div",5)(6,"h2",6),t._uU(7,"Bienvenido de vuelta"),t.qZA(),t.TgZ(8,"h4",7),t._uU(9," Inicia sesi\xf3n con tus credenciales. "),t.qZA()(),t.TgZ(10,"div",8)(11,"div",9)(12,"mat-form-field",10)(13,"mat-label"),t._uU(14,"Correo electr\xf3nico"),t.qZA(),t._UZ(15,"input",11),t.YNc(16,C,2,0,"mat-error",12),t.qZA(),t.TgZ(17,"mat-form-field",10)(18,"mat-label"),t._uU(19,"Contrase\xf1a"),t.qZA(),t._UZ(20,"input",13),t.TgZ(21,"button",14),t.NdJ("click",function(){return a.toggleVisibility()}),t.YNc(22,A,1,0,"mat-icon",15)(23,k,1,0,"mat-icon",16),t.qZA(),t.TgZ(24,"mat-hint"),t._uU(25,"Haz clic en el ojo para alternar visibilidad"),t.qZA(),t.YNc(26,D,2,0,"mat-error",12),t.qZA()(),t.TgZ(27,"div",17)(28,"mat-checkbox",18),t._uU(29,"Recordarme"),t.qZA(),t.TgZ(30,"a",19),t._uU(31,"\xbfOlvidaste tu contrase\xf1a?"),t.qZA()(),t.TgZ(32,"button",20),t.NdJ("click",function(){return a.send()}),t.YNc(33,Z,2,0,"span",12)(34,O,2,0,"span",12),t.qZA(),t.TgZ(35,"button",21),t.NdJ("click",function(){return a.testLogout()}),t._uU(36," \u{1f9ea} Probar Logout "),t.qZA()()()()),2&n&&(t.xp6(),t.Q6J("@fadeInUp",void 0),t.xp6(9),t.Q6J("formGroup",a.form),t.xp6(6),t.Q6J("ngIf",a.form.controls.email.hasError("required")),t.xp6(4),t.Q6J("type",a.inputType),t.xp6(2),t.Q6J("ngIf",a.visible),t.xp6(),t.Q6J("ngIf",!a.visible),t.xp6(3),t.Q6J("ngIf",a.form.controls.password.hasError("required")),t.xp6(4),t.Q6J("routerLink",t.DdM(11,U)),t.xp6(2),t.Q6J("disabled",a.loading||a.form.invalid),t.xp6(),t.Q6J("ngIf",!a.loading),t.xp6(),t.Q6J("ngIf",a.loading))},dependencies:[e.UX,e.Fj,e.JJ,e.JL,e.Q7,e.sg,e.u,i.lN,i.KE,i.hX,i.bx,i.TO,i.R9,x.c,x.Nt,b.O5,g.ot,g.lW,g.RK,h.AV,h.gM,v.Ps,v.Hw,f.p9,f.oG,_.rH,m.ZX],styles:[".bg-pattern[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--vex-background-background) 22px,var(--vex-background-hover) 22px,var(--vex-background-hover) 24px,transparent 24px,transparent 67px,var(--vex-background-hover) 67px,var(--vex-background-hover) 69px,transparent 69px),linear-gradient(225deg,var(--vex-background-background) 22px,var(--vex-background-hover) 22px,var(--vex-background-hover) 24px,transparent 24px,transparent 67px,var(--vex-background-hover) 67px,var(--vex-background-hover) 69px,transparent 69px) 0 64px;background-color:var(--vex-background-background);background-size:64px 128px}"],data:{animation:[d.$]},changeDetection:0})}return r})()}}]);